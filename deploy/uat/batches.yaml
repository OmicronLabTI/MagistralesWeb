apiVersion: batch/v1
kind: CronJob
metadata:
  name: finalize-productionorders-cronjob
  namespace: default
spec:
  schedule: "*/30 * * * *"
  timeZone: America/Mexico_City
  suspend: false # suspende el cron
  successfulJobsHistoryLimit: 1
  failedJobsHistoryLimit: 1
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      # automountServiceAccountToken: false
      template:
        spec:
          # automountServiceAccountToken: false
          containers:
            - name: finalize-productionorders-container
              image: omicron.azurecr.io/omicronuat/finalizeproductionordersmagistrales:latest
              imagePullPolicy: Always
              resources:
                requests:
                  cpu: "100m"
                  memory: "256Mi"
                limits:
                  cpu: "250m"
                  memory: "512Mi"
              env:
                - name: DOTNET_ENVIRONMENT
                  value: Uat
                - name: REDIS_CONNECTION_STRING
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: redis
                - name: TZ
                  value: America/Mexico_City
                - name: ASPNETCORE_ENVIRONMENT
                  value: Uat
                - name: KAFKA_EH_FQDN_2
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: kafka_eh_fqdn_2
                - name: KAFKA_RETRYFINALIZEORDER_EH_NAME
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: kafka_retryfinalizeorder_eh_name
                - name: KAFKA_EVENTHUB_NET_CONNECTION_RETRYFINALIZEORDER
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: kafka_eventhub_net_connection_retryfinalizeorder
                - name: KAFKA_RETRYFINALIZEORDER_CONSUMER_GROUP
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: kafka_retryfinalizeorder_consumer_group
          restartPolicy: OnFailure
          imagePullSecrets:
            - name: pullsecret
---
apiVersion: batch/v1
kind: CronJob
metadata:
  name: division-productionorderprocess-cronjob
  namespace: default
spec:
  schedule: "0 */2 * * *"
  timeZone: America/Mexico_City
  suspend: false # suspende el cron
  successfulJobsHistoryLimit: 1
  failedJobsHistoryLimit: 1
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      # automountServiceAccountToken: false
      template:
        spec:
          # automountServiceAccountToken: false
          containers:
            - name: division-productionorderprocess-container
              image: omicron.azurecr.io/omicronuat/divisionproductionorderprocessmagistrales:latest
              imagePullPolicy: Always
              resources:
                requests:
                  cpu: "100m"
                  memory: "256Mi"
                limits:
                  cpu: "250m"
                  memory: "512Mi"
              env:
                - name: DOTNET_ENVIRONMENT
                  value: Uat
                - name: REDIS_CONNECTION_STRING
                  valueFrom:
                    secretKeyRef:
                      name: omicron-uat
                      key: redis
          restartPolicy: OnFailure
          imagePullSecrets:
            - name: pullsecret
